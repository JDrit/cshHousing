<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CSH Housing Board">
    <meta name="author" content="JD">
    <link rel="icon" href="${request.static_url('cshhousing:static/images/favicon.ico')}">
    <title>CSH Housing Board</title>

    <link href="${request.static_url('cshhousing:static/css/bootstrap.css')}" rel="stylesheet">
    <link href="${request.static_url('cshhousing:static/css/deform_bootstrap.css')}" rel="stylesheet">
    <link href="${request.static_url('cshhousing:static/css/navbar.css')}" rel="stylesheet">
    <link href="${request.static_url('cshhousing:static/css/chosen.css')}" rel="stylesheet">

    <!-- Widget requirements -->
    <script src="${request.static_url('cshhousing:static/scripts/jquery-1.7.1.min.js')}" type="text/javascript"></script>
    <script src="${request.static_url('cshhousing:static/scripts/deform.js')}" type="text/javascript"></script>
    <script src="${request.static_url('cshhousing:static/scripts/deform_bootstrap.js')}" type="text/javascript"></script>
    <script src="${request.static_url('cshhousing:static/scripts/bootstrap.js')}" type="text/javascript"></script>
    <script src="${request.static_url('cshhousing:static/scripts/jquery_chosen/chosen.jquery.js')}" type="text/javascript"></script>

  </head>
  <body>
    <div class="container">

      <!-- Static navbar -->
      <div class="navbar">
        <div class="container">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">CSH Housing Board</a>
          <div class="nav-collapse collapse">
            <ul class="nav navbar-nav">
              <li><a href="/">Home</a></li>
              <li><a href="/join">Join Room</a></li>
              <li><a href="/leave">Leave Room</a></li>
            </ul>
            <ul class="nav navbar-nav pull-right">
              <li class="active"><a href="/admin">Admin</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
      
	  <div id="container">
            <div tal:repeat="msg msgs">
	      <?python type = "alert-danger" if msg.lower().startswith("warning") else "alert-info" ?>
              <div class="alert ${type}">
	        <button type="button" class="close" data-dismiss="alert">&times;</button>
	        <strong>${msg}</strong>
	      </div>
            </div>
              <ul class="nav nav-tabs">
                <li><a href="#list" data-toggle="tab">Room List</a></li>
                <li><a href="#add" data-toggle="tab">Add Rooms</a></li>
		<li><a href="#current" data-toggle="tab">Current Rooms</a></li>
		<li><a href="#log" data-toggle="tab">Logs</a></li>
		<li><a href="#settings" data-toggle="tab">Settings</a></li>
	      </ul>
              <div class="tab-content">
	        <div class="tab-pane active" id="list">
		  <h2>Room List</h2>
                 <table class="table table-hover table-striped">
                   <tr>
	             <td>Room Number:</td>
	             <td>Name 1:</td>
		     <td>Name 2:</td>
		     <td>Total Points</td>
		     <td>Locked:</td>
		     <td></td>
		     <td></td>
	           </tr>
	           <tr tal:repeat="room rooms">
		     <td>${room.number}</td>
		     <?python name1 = name_map[room.name1] if room.name1 in name_map else room.name1?>
		     <td>${name1}</td>
		     <?python name2 = name_map[room.name2] if room.name2 in name_map else room.name2?>
		     <td>${name2}</td>
		     <td>${room.points}</td>
		     <td>${room.locked}</td>
		     <td>
                       <a href="/edit/${room.number}">
                         <button type="button" class="btn btn-default" action="">Edit</button>
                       </a>
                     </td>
                     <td>
                       <a href="/delete/${room.number}">
		         <button type="button" class="btn btn-danger">Delete</button>
                       </a>
                     </td>
	           </tr>
                </table>
		</div>
	        <div class="tab-pane" id="add">
		  <h2>Add Room</h2>
                  <span tal:replace="structure form"/>
		</div>
		<div class="tab-pane" id="current">
		  <h2>Current room assignments</h2>
		  <h4><em>used for determine squattings points</em></h4>
		  <table class="table table-hover table-striped">
                    <tr>
                      <td>Member's Name</td>
                      <td>Current Room</td>
                      <td>Housing Points</td>
		      <td></td>
                    </tr>
                    <tr tal:repeat="user users">
		      <?python user_name = name_map.get(user.name, user.name)?>
                      <td>${user_name}</td>
                      <td>${user.number}</td>
                      <?python points = points_map.get(user.name, 0)?>
                      <td>${points}</td>
                     <td>
                       <a href="/delete_current/${user.name}">
		         <button type="button" class="btn btn-danger">Delete</button>
                       </a>
                     </td>
                    </tr>
                  </table>   
                  <span tal:replace="structure current_rooms_form"/>
		</div>
		<div class="tab-pane" id="log">
		  <h2>View Logs</h2>
		  <a href="/delete_logs">
                    <button type="button" class="btn btn-primary btn-lg">Clear Logs</button>
                  </a>
                  <table class="table table-hover table-striped">
	            <tr>
                      <td>Date:</td>
	              <td>Name:</td>
                      <td>Action:</td>
		      <td>Description:</td>
		    </tr>
		    <tr tal:repeat="log logs">
		      <?python s = log.date.strftime('%Y-%m-%d %H:%M') ?>
		      <?python name = name_map.get(log.uid_number, log.uid_number) ?>
 	              <td>${s}</td>
		      <td>${name}</td>
	              <td>${log.log_type}</td>
                      <td>${log.log_data}</td>
		    </tr>
                  </table>
		</div>
		<div class="tab-pane" id="settings">
		  <h2>Settings</h2>
		  <br />
                  <div class="row">
		    <div class="col-lg-3">
		    <a href="/close">
		      <?python button_text = "Lock" if not locked else "Unlock" ?>
		      <?python button_desc = "This will lock the site to stop users from signing up for rooms" if not locked else "This will unlock the site to allow users to start signing up for rooms" ?>
		      <button type="button" class="btn btn-primary btn-lg">${button_text}</button>
                    </a>
			</div>
<div class="col-lg-9">
		      <h3>${button_desc}</h3></div></div>
		</div>
              </div>
 	      <script>
	        $(function () {
		  $('#myTab a:last').tab('show');
	        })
	      </script>
	      <br />
            </div>
    </div> <!-- /container -->

  </body>
</html>
