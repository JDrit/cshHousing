<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CSH Housing Board">
    <meta name="author" content="JD">
    <link rel="icon" href="${request.static_url('cshhousing:static/images/favicon.ico')}">
    <title>CSH Housing Board</title>

    <link href="${request.static_url('cshhousing:static/css/bootstrap.css')}" rel="stylesheet">
    <link href="${request.static_url('cshhousing:static/css/navbar.css')}" rel="stylesheet">

    <script src="${request.static_url('cshhousing:static/scripts/jquery-1.7.1.min.js')}" type="text/javascript"></script>
    <script src="${request.static_url('cshhousing:static/scripts/bootstrap.js')}" type="text/javascript"></script>
  </head>

  <body>

    <div class="container">

      <!-- Static navbar -->
      <div class="navbar">
        <div class="container">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Housing Board</a>
          <div class="nav-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="active"><a href="/">Home</a></li>
              <li><a href="/join">Join Room</a></li>
              <li><a href="/leave">Leave Room</a></li>
            </ul>
            <ul class="nav navbar-nav pull-right">
              <li><a href="/admin">Admin</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
        <h1><img src="${request.static_url('cshhousing:static/images/logo.png')}"/> Housing Board</h1>
	  <br />
	  <div tal:repeat="msg msgs">
	    <?python type = "alert-danger" if msg.lower().startswith("warning") else "alert-info" ?>
            <div class="alert ${type}">
	      <button type="button" class="close" data-dismiss="alert">&times;</button>
	      <strong>${msg}</strong>
	    </div>
          </div>
	  <div tal:condition="locked">
            <h2>Site is now closed, no more changes can be made</h2>
            <br />
          </div>
          <div class="panel">
            <div class="panel-heading"><h3 class="panel-title">User's Stats</h3></div>
            <h4>Housing Points: ${points}</h4>
	    <h4 tal:condition="current is not None">Current Room: ${current}</h4>
	    <h4 tal:condition="next_room is not None and not locked">Next Year's Room: ${next_room}<div class="pull-right"><a href="/leave"><button type="button" class="btn btn-danger">Leave Room</button></a></div></h4>
          </div>

	  <table class="table table-hover table-striped">
            <tr>
	      <td>Room Number:</td>
	      <td>Name 1:</td>
	      <td>Name 2:</td>
	      <td>Total Points</td>
	      <td>Locked:</td>
            </tr>
	      <tr tal:repeat="room rooms" tal:attributes="class 'warning' if room.locked else None">
		<td>${room.number}</td>
                <?python name1 = name_map[room.name1] if room.name1 in name_map else room.name1?>
		<td>${name1}</td>
		<?python name2 = name_map[room.name2] if room.name2 in name_map else room.name2?>
		<td>${name2}</td>
		<td>${room.points}</td>
		<td>${room.locked}</td>
	      </tr>
            </table>
	<br />
        <p>
        </p>
      </div>

    </div> <!-- /container -->

  </body>
</html>
